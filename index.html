<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>13Corp — IT помощь и услуги</title>

<!-- Подключаем fflate -->
<script src="https://cdn.jsdelivr.net/npm/fflate@0.7.4/umd/index.js"></script>

<style>
:root{
  --bg:#0A0F18; --text:#E8F2FF; --accent:#41B3FF; --accent2:#0099FF;
  --glass:rgba(255,255,255,0.05); --border:rgba(255,255,255,0.18); --radius:22px;
  --shadow:0 0 15px rgba(0,170,255,0.25); --header-height:80px;
}
*{margin:0;padding:0;box-sizing:border-box;font-family:Inter,sans-serif;}
body,html{width:100%;height:100%;overflow-x:hidden;background:var(--bg);color:var(--text);}
.h-wrap{display:flex;height:100vh;scroll-snap-type:x mandatory;overflow-x:auto;overflow-y:hidden;scroll-behavior:smooth;}
.h-wrap::-webkit-scrollbar{height:10px;}
.h-wrap::-webkit-scrollbar-thumb{background:var(--accent);border-radius:999px;}
section{flex:0 0 100%;height:100vh;scroll-snap-align:start;display:flex;justify-content:center;align-items:center;padding-top:var(--header-height);}
.block{width:90%;max-width:1250px;height:calc(100% - var(--header-height));background:var(--glass);backdrop-filter:blur(14px);border:1px solid var(--border);border-radius:var(--radius);padding:30px;box-shadow:var(--shadow);opacity:0;transform:translateY(20px);animation:fadeInUp .8s ease forwards;}
@keyframes fadeInUp{from{opacity:0;transform:translateY(20px);}to{opacity:1;transform:translateY(0);}}

h1{font-size:32px;margin-bottom:14px;} 
label{display:block;opacity:.7;margin-top:6px;font-size:11px;text-align:center;}
input,textarea,button{width:100%;padding:6px;border-radius:8px;border:1px solid var(--border);background:#0003;color:white;font-size:12px;}
button{background:linear-gradient(90deg,var(--accent),var(--accent2));color:#fff;font-weight:700;cursor:pointer;margin-top:6px;}
.progress-container{width:100%;background:rgba(255,255,255,0.1);border-radius:6px;margin-top:8px;overflow:hidden;height:10px;}
.progress-bar{width:0%;height:100%;background:linear-gradient(90deg,var(--accent),var(--accent2));transition:width 0.2s;}
.col{display:flex;flex-direction:column;gap:8px;width:100%;max-width:350px;margin:0 auto;text-align:center;}
@media(max-width:650px){.col{max-width:300px;} input,textarea,button{font-size:11px;}}
</style>
</head>
<body>

<div class="h-wrap" id="hwrap">

<!-- 4 блок — форма с прогресс-баром -->
<section>
  <div class="block">
    <h1 style="font-size:18px;text-align:center;">Оформить заказ</h1>
    <div class="col">
      <label>Название задачи</label>
      <input id="title" placeholder="Например: восстановление wallet.dat">
      <label>Описание</label>
      <textarea id="desc" rows="3" placeholder="Опишите задачу подробно"></textarea>
      <label>Файлы</label>
      <input type="file" id="files" multiple>
      <label>Обратная связь (Email или Телефон)</label>
      <input id="contact" placeholder="Ваш Email или Телефон">
      <button id="sendMail">Отправить</button>
      <div class="progress-container"><div class="progress-bar" id="progressBar"></div></div>
      <p id="status" style="font-size:12px;color:#ccc;margin-top:5px;text-align:center;">Файлы будут заархивированы перед отправкой</p>
    </div>
  </div>
</section>

</div>

<script>
document.getElementById('sendMail').onclick = async () => {
  const title = document.getElementById('title').value.trim();
  const desc = document.getElementById('desc').value.trim();
  const contact = document.getElementById('contact').value.trim();
  const filesInput = document.getElementById('files');
  const status = document.getElementById('status');
  const progressBar = document.getElementById('progressBar');

  if(!title || !desc || !contact){alert('Заполните все поля!'); return;}
  status.textContent = 'Создание архива...';
  progressBar.style.width = '0%';

  try {
    const zipData = {};
    zipData['заказ.txt'] = new TextEncoder().encode(`Название: ${title}\nОписание: ${desc}\nКонтакт: ${contact}`);

    for(let i=0; i<filesInput.files.length; i++){
      const file = filesInput.files[i];
      const arrayBuffer = await file.arrayBuffer();
      zipData[file.name] = new Uint8Array(arrayBuffer);
    }

    const zipped = fflate.zipSync(zipData, (meta) => {
      progressBar.style.width = Math.round(meta.percent*100)+'%';
      status.textContent = `Архивирование: ${Math.round(meta.percent*100)}%`;
    });

    const blob = new Blob([zipped], {type:'application/zip'});
    status.textContent = 'Отправка на почту...';
    progressBar.style.width = '100%';

    const formData = new FormData();
    formData.append('_subject','Новый заказ с сайта 13Corp');
    formData.append('_captcha','false');
    formData.append('order', blob, 'order.zip');

    const response = await fetch('https://formsubmit.co/13corpmail@proton.me',{method:'POST',body:formData});
    if(!response.ok) throw new Error('Ошибка отправки на сервер');

    status.textContent='✅ Заказ отправлен!';
    document.getElementById('title').value='';
    document.getElementById('desc').value='';
    document.getElementById('contact').value='';
    filesInput.value='';
    progressBar.style.width='0%';

  } catch(e){
    console.error(e);
    status.textContent=`❌ Ошибка: ${e.message}`;
    progressBar.style.width='0%';
  }
};
</script>

</body>
</html>
